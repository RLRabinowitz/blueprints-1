version: 1

deploy:
  steps:
    terraformInit:
      before:      
        - mkdir -p ~/.ssh
        - echo "$SSH_PRIVATE_KEY" | tr ';' '\n' | tr -d "\r" > ~/.ssh/private_tf_modules
        - chmod 400 ~/.ssh/private_tf_modules
        - echo -e "Host github.com\n User git\n Hostname github.com\n IdentityFile ~/.ssh/private_tf_modules\n StrictHostKeyChecking no" > ~/.ssh/config
        - echo "Created private key"
